## 有意义的命名

> 起个好名字的简单规则

### 名副其实

-   命名应**准确**的描述这个变量: 为什么存在,做了什么事,该怎么用.降低变量的模糊度
-   一旦发现更好的名称,就替换掉旧的

### 避免误导

-   变量的**外形**要容易区分

    ```
    bad:
    cosnt XYZControllerForEfficientHandlingOfStrings = 1;
    const XYZControllerForEfficientStrageOfStrings = 2;
    ```

-   变量所表达的**意思**要容易区分,禁止混用data和info,a和the

    ```
    bad:
    prodctInfo与prodctData
    ```

-   减少不必要的描述

    -   table永远不要出现在表名中
    -   nameString,后缀string就是完全多余的描述

### 易读

便于见字照着拼读,无论是阅读代码还是讨论代码的时候,非常有用

### 避免重复

重复的命名空间的出现是会让读者很恼火的,因为识别重复是不容易的,这样的重复也会导致问题,让代码因此而臃肿,且当需要修改时很可能要修改所有重复的地方

```
bad:
setUp()
suiteSetUp()
tearDown()
suiteTearDown()
```
### 使用搜的到的名称

对于单字母或者数字,再搜索的时候很难单独搜到,它们往往是其他代码的一部分,在这方面长名称要胜于短名称,而*名称的长短应该与其作用域大小相对应*.
```js
找Max_CLASSES_PER_STUDENT容易,找7就难了
```

### 避免使用额外的编码

不要将类型,作用域,各种前导字母,前缀编写进名称里面,容易让人在理解必要的代码之外分出来精力理解这些`额外的编码`,同时带编码的词语也不便发音

### 避免产生思维映射

在循环中通常会使用`i,j,k,item`等惯用字母进行操作,但他们实际上并没有表达明确表达出自己是干什么的,需要读者在脑中映射为具体的真实概念;例如一个`r`表示的是`不包含主机名和模式的小写url`的话,读这样的代码压力一定很大

不只在循环中,在所有编码中都要避免使读者产生思维映射

### 类名

类名和对象名应该是名词或名词短语,不应该是动词,应该避免Data,Info,Processor,Manager这样的类名

### 方法名

方法名应当是动词或者动词短语

### 别耍小聪明

不要用俗话,俚语来命名,虽然有时后挺好玩,但是宁可明确,毋为好玩

### 每个概念对应一个词

每个抽象概念固定使用一个词来描述,对`管理者`这个类命名时,如果即用`Manager`来命名,在另一个地方又用`Admin`来命名,这会让人感到疑惑: 为什么不使用一个命名呢,难道是表示的意思不同?从而产生理解负担

### 别用双关语

对于一词多义的单词尽量不要使用,保证一词一义

### 使用解决方案领域名称

只用程序员才会阅读你的代码,尽量使用计算机领域的术语,而非问题出现领域的术语

### 使用问题涉及领域的名称

若不能用熟悉的术语进行命名,那么应使用所涉及问题领域的而来的名称,这能保证`有迹可循`

### 添加有意义的语境

### 不要使用没用的语境

## 函数

### 短小

每个函数应尽量保持短小,且依次的将你带到下一个函数

if语句,else语句,while语句等,其中的代码应该只占用一行,该行一般应是一个函数调用语句,这样可以保证函数足够短小

### 只做一件事

什么是只做一件事: 如果函数只是做了函数名下同一抽象层的步骤,则函数还是只做了一件事.

### 每个函数一个抽象层级

要确保一个函数只做一件事,同一个函数中的语句就应该在同一个抽象级上.每个函数只做它这一抽象级的事情.

什么是一个抽象层级?

```js
if(arg < 0){
    ...
}else {
    ...
}
上述代码中if-else就是一个层级,这个层级只用来做判断,而括号中做的事情就是下一个层级,因此封装成函数时应该是这样
function fn(arg) {
    if(arg < 0){
        函数1
    }else {
       函数2
    }
}
```

#### 自顶向下读代码: 向下规则

想让我们的代码拥有自顶向下的阅读顺序,就要让每个函数后面跟着位于下一抽象层级的函数,当函数之间相互调用的时候,顶层函数的抽象级范围应该是最大的,而且随着函数调用的层级越深,函数的抽象层级理应越小,这也就是**向下规则**,

**这是保持函数短小,只做一件事的要诀**

### 函数名称

给函数起一个能描述清功能的名字,**不要担心长名称,长而具有描述性的名称,要比短而令人费解的名称好,要比描述性的长注释好**

最好使用某种命名约束如:驼峰命名法,单词简写等让名称中的多个单词容易阅读,

结合只做一件事和每个函数一个抽象层级,这三者最终产生的效果应该是: 随着函数调用层级越来越深,函数的抽象层级越来越小,函数做的事情粒度越来越小,而函数的命名则越来越长.

最好的实践就是对同一个函数尝试不同的名称,实测其阅读效果,使用效果最好的那个

### 分隔开指令和询问

函数要么做什么事,要么回答什么事,两者不能兼得.

### 使用异常

- 抽离try/catch代码块

  抽离try和catch中的代码,形成函数

  ```js
  try{
      deletePage();
      deleteAttribute()
  }catch(e){
      throw e
  }
  抽离:
  try{
      deletePageAndAttribut()
  }catch(e){
      throwError(e)
  }
  function deletePageAndAttribut(){
      deletePage();
      deleteAttribute()
  }
  function throwError(err){
      throw err
  }
  
  ```

- 错误处理就是一件事

  遵循单一职责原则,处理错误的函数不应该进行其他活动.也就是说一个函数中只能由try/catch/finally的逻辑,不再由其他的

### 使用解释变量

顾名思义,解释变量就是用来解释他是干什么的,没有其他用处.什么场景下需要使用解释变量呢?最最常见的就是在判断的时候: 

```js
function fn(idx){
    if(idx > 0 && idx < 10){
        do...
    }else{
        do....
    }
}
看上述代码,如果我们不去读括号中的逻辑,那么永远也不知道(idx > 0 && idx < 10)这个判断条件是什么意思,这时候用上解释变量,立马就上代码的可读性上升了一个档次:
function fn(idx){
    let isSingleDigit = idx > 0 && idx < 10;
    if(isSingleDigit){
        do...
    }else{
        do....
    }
}
```

### 如何写出这样的函数

精致的代码是不断打磨出来的,一开始往往都是冗长而复杂,大量的嵌套,大量的循环,当初稿完成后,再对其斟酌推敲,分解函数?修改名称?消除重复?等等,即要考虑实现业务逻辑,又要实现精致代码是比较困难的,因此,先完成初稿,然后才去琢磨规则

## 注释

本章精髓: 用函数,变量名来阐述意图才是最好的注释,首要的是想办法不写注释而表达清楚意图,其次才是如何写好注释

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/935badce09a84b51b71cda93322141e3~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=267&h=244&s=62693&e=png&b=fafafa)

## 格式

选用一套管理代码格式的简单规则,并应用,能大幅度提高代码的可维护性

### 垂直方向上的格式

#### 排版

关注整个源文件中代码的排版是很重要的,参考报纸的写法: 当我们从上到下阅读报纸时,头部有个大标题: 告诉我们故事主题,第一段是整个故事的大纲,给出粗略的主题内容,但是隐藏了细节,接着读下去细节渐次增加,直至我们完全了解所有内容,

源文件亦是如此: 首先文件名应该简单且一目了然,其次源文件中由上至下应该是: 由抽象层级较高的函数和他们之间的调用组成主要的逻辑线,然后是下一抽象层级的函数,其中的细节应该往下逐渐展开,直至找到源文件中最底层的函数和细节

#### 适当的隔离

导入导出,变量声明,函数之间等都用空行隔开,这条空行会暗示读者空行隔开的是不同的概念

#### 适当的紧凑

空行隔开各个概念,而相邻的代码则暗示了他们之间的紧密联系,所以紧密相关的代码应该相互靠近在一起.

#### 垂直距离

对于哪些关系密切,放置在同一源文件中的概念,他们在书写的位置距离应该成为对彼此易懂度影响有多重要的标准,避免读者在源文件中跳来跳去.换句话说关系密切的概念之间的距离应该尽量小,

**如何控制概念之间的垂直距离?下面是一些建议:**

**变量声明:** 变量声明应该尽可能的靠近其使用的位置

**实体变量:** 实体变量应该在类的顶部声明

**相关函数:** 若某个函数调用了另外一个,就应该把他们放在一起,且调用者应该在被调用者的上面

**概念相关:** 上述讲的相关性都是建立在直接依赖的基础上,编写代码时也会出现其他的相关性: 操作相似的函数等这时,函数之间即使没有调用关系也应该放在你一起

#### 垂直顺序

通常我们希望建立一种自顶向下贯穿源代码模块的信息流,自上向下展示函数调用顺序,使最重要的概念先出现,并且尽可能少的包含细节,最底层的细节最后出现

就如排版一节中说的: 由抽象层级高的函数组成逻辑线(信息流),这样我们就能扫一眼源代码文件,自最前面的几个函数获取主要信息,而不被细节所消耗精力

### 横向方向上的格式

#### 一行代码应该多宽?

最好遵循**无需拖动滚动条就能看到最右侧代码**的原则,不要让一行代码超出了你的屏幕

#### 适当的隔离/紧凑

虽然现在的编辑器会自动格式化代码,但Bob大叔的空格用法很妙:

使用空格来强调区隔关系: 如操作符两边,函数参数之间,

不使用空格来表示关系密切: 如函数名和圆括号.同时也可以用来强调优先级:

下面是一些伪代码例子:

```
const a = 1; //等号两边使用空格,强调两个要素: 左边和右边
function fn(a, b, c){} //函数名和后面的括号不加空格,用来强调这是一体的,而参数中使用空格强调每个参数都是独立的
b*b - 4*a //乘法优先级较高,所以乘号两边不使用空格间隔
```

#### 缩进

使用缩进来代表层级和范围

### 团队风格

每个程序员都有自己喜欢的格式,但在团队中工作,就是团队说的算,和团队成员一起指定规则并遵守,记住,好的软件系统是一系列拥有一致风格的代码文件组成,不是一个或几个文件.让读者确信,他在一个源文件中看到的代码风格在其他文件也是适用的.